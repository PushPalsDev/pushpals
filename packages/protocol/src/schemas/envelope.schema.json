{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "EventEnvelope",
  "type": "object",
  "required": ["protocolVersion", "id", "ts", "sessionId", "type", "payload"],
  "properties": {
    "protocolVersion": {
      "type": "string",
      "const": "0.1.0",
      "description": "Protocol version must be 0.1.0"
    },
    "id": {
      "type": "string",
      "description": "Unique event identifier (e.g., UUID)"
    },
    "ts": {
      "type": "string",
      "format": "date-time",
      "description": "ISO-8601 timestamp"
    },
    "sessionId": {
      "type": "string",
      "description": "Session identifier"
    },
    "type": {
      "type": "string",
      "enum": [
        "log",
        "scan_result",
        "suggestions",
        "diff_ready",
        "approval_required",
        "approved",
        "denied",
        "committed",
        "error",
        "done"
      ],
      "description": "Event type discriminator"
    },
    "traceId": {
      "type": "string",
      "description": "Optional trace ID for debugging"
    },
    "payload": {
      "type": "object",
      "description": "Payload depends on event type"
    }
  },
  "additionalProperties": false
}
